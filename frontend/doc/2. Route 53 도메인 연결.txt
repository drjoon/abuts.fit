2. Route 53 호스팅 영역 생성

# 호스팅 영역(Hosted Zone) 확인 또는 생성
# abuts.fit 도메인에 대한 Route 53 호스팅 영역이 있는지 확인
aws route53 list-hosted-zones-by-name --dns-name abuts.fit

# 권한 없으면 IAM에서 AmazonRoute53FullAccess 추가 

# 생성되지 않았다면 생성
aws route53 create-hosted-zone --name abuts.fit --caller-reference $(date +%s)

# 출력되는 NS 레코드를 도메인 등록기관에 등록해야 함
ns-1044.awsdns-02.org
ns-647.awsdns-16.net
ns-1554.awsdns-02.co.uk
ns-418.awsdns-52.com


3. Route 53 레코드(Alias) 생성

1) S3 웹사이트 엔드포인트를 확인:
 - ap-south-1 리전: abuts.fit.s3-website.ap-south-1.amazonaws.com

2) route53 change-resource-record-sets 명령어로 A 레코드 생성:
# change-batch.json 예시
{
  "Comment": "S3 website alias",
  "Changes": [
    {
      "Action": "UPSERT",
      "ResourceRecordSet": {
        "Name": "abuts.fit",
        "Type": "A",
        "AliasTarget": {
          "HostedZoneId": "Z11RGJOFQNVJUP",
          "DNSName": "s3-website.ap-south-1.amazonaws.com.",
          "EvaluateTargetHealth": false
        }
      }
    }
  ]
}

HostedZoneId는 리전마다 다름.
ap-south-1: Z11RGJOFQNVJUP
전체 목록 공식문서

# 호스팅 존 ID 확인
aws route53 list-hosted-zones-by-name --dns-name abuts.fit
# 레코드 등록
aws route53 change-resource-record-sets --hosted-zone-id Z0070040387JJQBR7DLBD --change-batch file://doc/change-batch.json
# 레코드 확인
aws route53 list-resource-record-sets --hosted-zone-id Z0070040387JJQBR7DLBD --query "ResourceRecordSets[?Type == 'A']"
# Mac에서 DNS 캐시 지우는 명령어:
sudo killall -HUP mDNSResponder

# 네임 서버 변경 확인
nslookup  abuts.fit
dig abuts.fit

4.  (선택) www 리디렉션도 CLI로 처리
www.abuts.fit 버킷 생성 및 리디렉션 설정
Route 53에 www 레코드 추가


5. 배포
aws s3 sync ./dist s3://abuts.fit

참고:
1) 도메인 등록기관에 NS 레코드 등록은 CLI로 불가(수동)
2) HTTPS 적용은 CloudFront 필요(추가 안내 가능)