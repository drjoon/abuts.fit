1. 준비
- AWS CLI 자격증명(profile) 설정 확인: aws sts get-caller-identity --profile abuts.fit
- Lambda 함수 이름/ARN, 리전, 필요한 환경변수(SES 도메인/이메일, QUEUE/SNS/SQS 등) 확인.

2. 패키징 (Node.js 예시)
  - 함수 루트에서 의존성 설치: npm ci --omit=dev
  - 배포 ZIP 생성: zip -r lambda.zip index.js node_modules package.json # (필요 파일 포함)
  - 새로 만들기
    aws lambda create-function \
  --function-name ABUTS-EMAIL-INBOUND \
  --runtime nodejs18.x \
  --role arn:aws:iam::106055905364:role/abuts-email-inbound-role \
  --handler index.handler \
  --zip-file fileb://lambda.zip \
  --profile abuts.fit --region ap-south-1

3. 배포
- 배포 ZIP 생성:
zip -r lambda.zip index.js node_modules package.json # (필요 파일 포함)
- 업데이트:
aws lambda update-function-code \
    --function-name ABUTS-EMAIL-INBOUND \
    --zip-file fileb://lambda.zip \
    --profile abuts.fit --region ap-south-1

- 환경변수 (prod):
aws lambda update-function-configuration \
  --function-name ABUTS-EMAIL-INBOUND \
  --environment "Variables={USE_LOCAL_WEBHOOK=false,EMAIL_BUCKET=abuts-fit-email,RAW_PREFIX=emails/raw/,ATTACH_PREFIX=emails/attachments/,WEBHOOK_URL=https://abuts.fit/api/webhooks/mail,WEBHOOK_URL_LOCAL=http://localhost:5173/api/webhooks/mail,MAIL_WEBHOOK_SECRET=3WKblafMNLpxsglta8tEtdUpe+DYrXQhRRsQ314/cBY=}" \
  --profile abuts.fit --region ap-south-1